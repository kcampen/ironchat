function formatTime(a){var b=moment(a).calendar();return b}function getNewMessages(){messages.fetch({success:function(){},error:function(){console.log("fetch failed!")}})}var Message=Backbone.Model.extend({idAttribute:"_id",defaults:{options:{},username:"",messageText:"yo",appId:"ironchat"},initialize:function(){}}),MessagesCollection=Backbone.Collection.extend({model:Message,url:"http://tiny-pizza-server.herokuapp.com/collections/messages",comparator:"messageDate",initialize:function(){console.log("initializing collection"),this.listenTo(this,"change",function(){}),this.listenTo(this,"add",function(a){new ListView({model:a})})},parse:function(a){return console.log("entered parse method!"),_.filter(a,function(a){return _.isNumber(a.messageDate)&&""!=a.username})}}),ListView=Backbone.View.extend({className:"new-message",newTemplate:_.template($("#main-template").text()),initialize:function(){$(".message-list").append(this.el),this.render(),$(".message-list").scrollTop(5e8)},render:function(){var a=_.clone(this.model.attributes);a.messageDate=formatTime(a.messageDate);var b=this.newTemplate(a);this.$el.html(b)}});console.log("You can do it!");var messages=new MessagesCollection,currentUser={username:"IronYard Student"};$(".msg-input").keyup(function(a){13==a.keyCode&&$(".send-msg-btn").click()}),$(".send-msg-btn").click(function(){if(""!==$(".msg-input").val()){var a=new Message({messageText:$(".msg-input").val(),username:currentUser.username,messageDate:_.now()}),b=messages.add(a);b.save(),$(".msg-input").val("")}}),messages.fetch({reset:!0,success:function(){messages.each(function(a){new ListView({model:a}),$(".message-list").scrollTop(5e9)})},error:function(){console.log("problem with initial page load fetch")}}),setInterval(getNewMessages,1e3);